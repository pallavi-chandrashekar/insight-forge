---
name: "E-Commerce Analytics"
version: "1.0.0"
description: "Complete e-commerce analytics spanning orders, customers, and products"
context_type: "multi_dataset"
status: "active"
category: "e-commerce"
tags: ["sales", "customers", "analytics"]

# Multiple datasets
datasets:
  - id: "orders"
    name: "Orders"
    dataset_id: "order-dataset-uuid-here"
    description: "Order transactions"
    columns:
      - name: "order_id"
        business_name: "Order ID"
        description: "Unique order identifier"
        data_type: "string"
      - name: "customer_id"
        business_name: "Customer ID"
        description: "Reference to customer"
        data_type: "string"
      - name: "product_id"
        business_name: "Product ID"
        description: "Reference to product"
        data_type: "string"
      - name: "quantity"
        business_name: "Quantity"
        description: "Number of items ordered"
        data_type: "integer"
      - name: "total_amount"
        business_name: "Total Amount"
        description: "Total order value"
        data_type: "decimal"
      - name: "order_date"
        business_name: "Order Date"
        description: "When the order was placed"
        data_type: "datetime"

  - id: "customers"
    name: "Customers"
    dataset_id: "customer-dataset-uuid-here"
    description: "Customer information"
    columns:
      - name: "customer_id"
        business_name: "Customer ID"
        description: "Unique customer identifier"
        data_type: "string"
      - name: "customer_name"
        business_name: "Customer Name"
        description: "Full name of customer"
        data_type: "string"
      - name: "email"
        business_name: "Email Address"
        description: "Customer email"
        data_type: "string"
      - name: "signup_date"
        business_name: "Signup Date"
        description: "When customer registered"
        data_type: "datetime"
      - name: "customer_segment"
        business_name: "Customer Segment"
        description: "VIP, Regular, New"
        data_type: "string"

  - id: "products"
    name: "Products"
    dataset_id: "product-dataset-uuid-here"
    description: "Product catalog"
    columns:
      - name: "product_id"
        business_name: "Product ID"
        description: "Unique product identifier"
        data_type: "string"
      - name: "product_name"
        business_name: "Product Name"
        description: "Name of the product"
        data_type: "string"
      - name: "category"
        business_name: "Category"
        description: "Product category"
        data_type: "string"
      - name: "price"
        business_name: "Price"
        description: "Product price"
        data_type: "decimal"

# Relationships between datasets
relationships:
  - id: "order_customer"
    name: "Order to Customer"
    type: "many_to_one"
    from_dataset: "orders"
    from_column: "customer_id"
    to_dataset: "customers"
    to_column: "customer_id"
    description: "Each order belongs to one customer"

  - id: "order_product"
    name: "Order to Product"
    type: "many_to_one"
    from_dataset: "orders"
    from_column: "product_id"
    to_dataset: "products"
    to_column: "product_id"
    description: "Each order line references one product"

# Cross-dataset metrics
metrics:
  - id: "total_revenue"
    name: "Total Revenue"
    expression: "SUM(orders.total_amount)"
    datasets: ["orders"]
    description: "Total revenue from all orders"

  - id: "avg_order_value"
    name: "Average Order Value"
    expression: "AVG(orders.total_amount)"
    datasets: ["orders"]
    description: "Average value per order"

  - id: "customer_lifetime_value"
    name: "Customer Lifetime Value"
    expression: "SUM(orders.total_amount) GROUP BY orders.customer_id"
    datasets: ["orders", "customers"]
    description: "Total revenue per customer"

  - id: "top_products"
    name: "Top Selling Products"
    expression: "SUM(orders.quantity) GROUP BY orders.product_id"
    datasets: ["orders", "products"]
    description: "Products by total quantity sold"

  - id: "revenue_by_category"
    name: "Revenue by Category"
    expression: "SUM(orders.total_amount) JOIN products ON orders.product_id = products.product_id GROUP BY products.category"
    datasets: ["orders", "products"]
    description: "Revenue broken down by product category"

# Business glossary (shared across datasets)
glossary:
  - term: "Customer Lifetime Value"
    definition: "Total revenue generated by a customer over their entire relationship with the business"
    synonyms: ["CLV", "LTV"]
    related_columns: ["orders.total_amount", "customers.customer_id"]

  - term: "Customer Segment"
    definition: "Classification of customers based on behavior and value"
    synonyms: ["Customer Type", "Customer Category"]
    related_columns: ["customers.customer_segment"]
    examples:
      - "VIP: High-value repeat customers"
      - "Regular: Standard customers"
      - "New: Recently signed up"

  - term: "Average Order Value"
    definition: "Mean transaction value across all orders"
    synonyms: ["AOV"]
    related_columns: ["orders.total_amount"]

# Filters that work across datasets
filters:
  - id: "vip_customers"
    name: "VIP Customers Only"
    condition: "customers.customer_segment = 'VIP'"
    datasets: ["customers", "orders"]
    description: "Filter to show only VIP customer data"

  - id: "recent_orders"
    name: "Recent Orders (Last 30 Days)"
    condition: "orders.order_date >= TODAY() - 30"
    datasets: ["orders"]
    description: "Orders from the last 30 days"

  - id: "high_value_orders"
    name: "High Value Orders"
    condition: "orders.total_amount > 100"
    datasets: ["orders"]
    description: "Orders above $100"

  - id: "electronics_category"
    name: "Electronics Only"
    condition: "products.category = 'Electronics'"
    datasets: ["products", "orders"]
    description: "Filter to electronics products"

# Business rules
business_rules:
  - id: "valid_order"
    name: "Valid Order Rule"
    rule: "orders.quantity > 0 AND orders.total_amount > 0"
    severity: "error"
    description: "Orders must have positive quantity and amount"

  - id: "customer_email_required"
    name: "Customer Email Required"
    rule: "customers.email IS NOT NULL AND customers.email LIKE '%@%'"
    severity: "warning"
    description: "Customers should have valid email addresses"

---

# E-Commerce Analytics Context

## Overview

This multi-dataset context integrates **Orders**, **Customers**, and **Products** data to provide comprehensive e-commerce analytics. Use this context to analyze sales performance, customer behavior, and product trends across all three datasets.

## Datasets

### 1. Orders Dataset
Contains all order transactions including:
- Order ID and timestamps
- Customer and product references
- Quantities and amounts
- Order status

### 2. Customers Dataset
Customer information including:
- Contact details
- Signup dates
- Customer segments (VIP, Regular, New)
- Demographics

### 3. Products Dataset
Product catalog with:
- Product names and descriptions
- Categories
- Pricing information
- Inventory status

## Key Relationships

### Order → Customer
Each order is placed by exactly one customer. Use `customer_id` to join orders to customer information.

**Example Query:**
```
Show me orders by VIP customers
```

### Order → Product
Each order line references one product. Use `product_id` to join orders to product details.

**Example Query:**
```
What are the top-selling products by revenue?
```

## Common Analysis Patterns

### Customer Analytics
- Customer lifetime value by segment
- Repeat purchase rate
- Customer acquisition trends
- Segment performance comparison

### Product Analytics
- Revenue by product category
- Best-selling products
- Product performance trends
- Category mix analysis

### Sales Analytics
- Daily/weekly/monthly revenue
- Average order value trends
- Sales by customer segment
- Revenue by product category

## Sample Questions

### Cross-Dataset Queries
- "Show total revenue by customer segment"
- "What are the top 10 products by revenue?"
- "Show average order value for VIP customers"
- "Which product categories generate the most revenue?"
- "Show customer lifetime value distribution"

### Single Dataset Queries
- "Show orders from the last 30 days" (Orders)
- "List all VIP customers" (Customers)
- "Show products in the Electronics category" (Products)

### Time-Based Analysis
- "Show revenue trends over the last 6 months"
- "Compare this month's sales to last month"
- "Show seasonal patterns in product sales"

## Pre-Defined Metrics

Use these pre-defined metrics in your queries:

- **Total Revenue**: Sum of all order amounts
- **Average Order Value**: Mean transaction value
- **Customer Lifetime Value**: Revenue per customer
- **Top Products**: Best sellers by quantity
- **Revenue by Category**: Sales breakdown by product type

## Filters Available

Apply these filters to narrow your analysis:

- **VIP Customers Only**: Focus on high-value customers
- **Recent Orders**: Last 30 days of transactions
- **High Value Orders**: Orders over $100
- **Electronics Only**: Filter to electronics products

## Data Quality Notes

- All orders have valid customer and product references
- Customer emails should be present and valid
- Orders must have positive quantities and amounts
- Dates are in ISO 8601 format
